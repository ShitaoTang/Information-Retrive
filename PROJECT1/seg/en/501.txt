 network working group j wong request for comments ucla nic april some comments on the official protocol categories b c c c c c document no and nwg rfc no gave a very detailed description of connection establishment connection termination and flow control over the network throughout the implementation of the ncp it was discovered that the handling of err control commands messages of types other than regular nop and rfnm and messages with the from imp bit on are not well discussed so that problems arise when they occur the protocol is not complete if the above situations are not handled clearly and the host host protocol glitch cleaning committee should take this into consideration in this document experience with these unfavorable situations and suggestions for handling are given err control commands in document no the following error conditions are described a illegal op code b end of message encountered before all expected parameters c bad socket polarity within commands d link number not in the range of l e a request other than rts str on a non existent socket f a request all gvb ret inr ins on a non existent link number g transmit over non existent link number other error conditions are h a request gvb ret inr ins on an existent link but connection is not established page i transmit over an existent link but connection is not established j all or gvb on a send connection k ret on a receive connection l an attempt to send more than the allocated number of bits or messages m eco erp err commands do not have the defined number of bits of data in document no each site is supposed to document the information on their err command no one has done that so far and the main reason is we are not sure of what information is important in nwg rfc no the text portion of the err commands is decided to have a fixed length of bits because bits is long enough to hold the longest non err command in some of the above error conditions more information than the command itself is desirable it was noted that these error conditions arise very often in the experimental stage of the ncp if every ncp is operating properly none of them should ever occur the err commands are therefore an excellent debugging tool for the protocol so it is desirable to define a set of possible error conditions and for each condition define a set of arguments in the corresponding err command so that enough information is given to tell what s wrong the suggested arguments for each situation a m are listed below a op code in error part of message following op code a maximum of bits b c d e f the command in error g link number beginning of message a maximum of bits h command in error socket numbers for the connection status of the connection page i link number beginning of message a maximum of bits socket numbers for the connection status of the connection j k command in error socket numbers for the connection l link number beginning of message a maximum of bits number of bits sent number of bits allocated number of messages allocated m the command in error each of the err commands should have a special error code bits to tell the error type an bits field to store the command in error and additional fields for socket numbers and other information imp to host messages of types other than and from the bbn report the following message types will cause difficulty in the implementation of the protocol a type imp going down b type destination host or imp dead c type incomplete transmission it was discovered that on sending a message to a site whose imp or host is not running a type or type message is returned this can happen in two situations a the foreign host or imp is not up at all b some connections have been established and the foreign host or imp goes down page the first situation does not cause much problem because the ncp has no entry in its table corresponding to this site the second situation is more complicated because if the table entries for the connections to the dead host are not cleared by the time this host comes up again the table entries still exist and the information will be very misleading one suggestion to solve this problem is a whenever a ncp comes up it send a reset control command to every other site b associated with each site there is a bit called the up bit if a reset reply command is received from some site the corresponding up bit is set to race condition can be avoided by ignoring all messages from sites which have not returned the reset reply command c messages can only be sent to sites with the up bit on d if a reset control command is received the table entries corresponding to the site are cleared a reset reply is immediately returned and the up bit for the site is set e the up bit is reset to when a type or type message is received from a particular site the above solution will handle the type messages also when a host receives a type message there is no way for it to tell the other ncp s that its imp is going down subsequent messages to this host will return a type or message the solution above will then come into effect page with the introduction of the reset and reset reply control command the eco and erp control command are no longer important and should be removed messages with the from imp bit on these kinds of messages are not discussed at all some statistical measurements have been made on messages with the from imp bit on we should classify what these messages represent this rfc was put into machine readable form for entry into the online rfc archives by randy dunlap page 