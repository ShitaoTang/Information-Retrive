 network working group m krilanovich request for comments ucsb nic may references rfcs nic remote job service at ucsb introduction this rfc is the follow on document to rfc which briefly described ucsb s rjs this document restates the essence of the official rje protocol rfc and documents in detail ucsb s implementation of it the program described here is available under socket at ucsb and supports a subset of the official protocol specifically no checks are made for rje control cards in the input file jobs may not be batched in the input file only output file dispositions of discard and transmit and discard are implemented no restart markers are sent on output in ftp blocked mode and several of the commands are not implemented there are also other ways in which rjs is known to be less than ideal for example whenever any error is detected while processing a job such as the output s destination host being dead the job is abandoned and any further output deleted a re write of rjs is scheduled for the near future in about six months and many of these deficiencies will be corrected at that time any suggestions for further improvements are more than welcome and may be made through the journal to mck by mail to the author at the ucsb computer center or by telephone at o in addition to the deviations from the protocol stated above several modifications have been made to increase user convience specifically the inacct outacct and acct commands have been added to accommodate users of tenex and other systems requiring an account number outpath has been added as a synonym for out and inuser for inid and the bye command does not cause an abort also in recognition of the fact that the official protocol is biased heavily toward use by programs and is therefore rather cumbersome for human users an alternate optional command syntax has been provided an attempt was made to make this alternate syntax called local syntax as natural as possible to a human user it also provides some features not available with the standard syntax krilanovich page rfc remote job service at ucsb may service provided the ucsb computer center operates an ibm and runs os mvt release and hasp all batch jobs at ucsb enter the system through hasp and therefore rjs acts as an interface between the user and hasp rjs s function is to provide the user with a hasp virtual rje terminal consisting of card reader card punch line printer and operator s console and to manage the first three of these for the user in response to commands issued by him by virtue of the fact that rjs maintains the correspondence between a particular user and the hasp rje terminal owned by him the user may issue commands to alter the status of those jobs submitted by him through his rje terminal this may be done even if the user has logged out of rjs and back in again possibly from another site the sequence of events involved in using rjs are as follows first the user logs in specifying a user name password and account number in addition to indicating how subsequent use of rjs is to be billed this accounting information identifies the owner of a particular rje terminal that is the association between user name and hasp virtual rje terminal is unique and only one individual is allowed logged in under a given user name at a time at present billing within rjs is not implemented and therefore the login account number is completely arbitrary and user name and password are relatively so the first time a given user name is used any password may be chosen thereafter as long as the user name is known to rjs the same password must be used a user name remains known to rjs while he is logged in and when he is not as long as he owns at least one job known to pjs otherwise the user name is discarded after a user is logged in he specifies input and output file information and requests input retrieval be initiated he may then log out or not as he wishes specifically he is not required to remain logged in during source file retrieval a job can completed abnormally at any stage of processing or normally after storage of the last of its output in any case the circumstances of the final disposition of the job are displayed to the user immediately if he is logged in saved for a period after its completion and are available to him on request the next time he logs in this status information is retained for at least a fixed period currently two days but will be retained longer as long as sufficient storage space is available for it krilanovich page rfc remote job service at ucsb may rjs commands general information in order to simplify specification of job parameters rjs maintains a set of accumulators for these parameters each accumulator is initially empty and may have its contents set or referred to by various commands the following parameter accumulators are maintained for each user user name password and account together are termed accounting parameters login accounting parameter those specified either in the login or the user pass and acct commands source pathname print pathname punch pathname source accounting parameter print accounting parameter and punch accounting parameter in addition associated with each job are the parameters source print and punch pathname and source print and punch accounting parameters when the telnet connections are first opened rjs sends the user a herald message of the form ucsb rjs ver tty where identifies the current version of rjs and identifies the user s terminal in the sense that each telnet connection is assigned a unique tty number during the process of running a job any of several spontaneous job status messages may be displayed to the user they are input retrieval for job has begun displayed when the input connection s have been established job has completed execution when the first of the job s printed output has been received from hasp printed or punched output from unknown job hasp job number is being discarded if printed or punched output is received from hasp over the user s line for a job not known to rjs and messages explaining errors such as icp rfc failure invalid job card null source deck missing pathname and data transfer network errors see appendix b for for a list of possible reply id s in addition while in local syntax the user may receive messages from hasp over his virtual operator s console some are responses to hasp commands issued by the user and others are spontaneous messages all however are asynchronous to the entering of other rjs commands certain general rules hold for both sets of syntax they are as follows the character pair cr lf is used as command accept to terminate commands other occurrences of these two characters are ignored and may be used as desired for local carriage control any number of blanks are permitted before or after any syntactic unit including the first and last krilanovich page rfc remote job service at ucsb may upper and lower case alphabetics are treated identically everywhere except in whenever a switch is made to the syntax not in effect the current telnet modes full or halfduplex character or line at a time are saved and reinstated when the current syntax is again entered in the syntactic descriptions below the following notation is used text denotes literal text quotes not part of text denotes name of syntactic unit denotes choice of syntactic units or denotes optional syntactic unit denotes group of syntactic units treated as a whole syntactic unit at left defined by statement on right the following general syntactic definitions are hereby made command accept a string of to alphameric characters a string of to alphameric characters a string of to alphameric characters a string of to alphameric characters the first of which is alphabetic krilanovich page rfc remote job service at ucsb may description of rjs commands standard syntax the following is a list of the commands supported in the standard syntax where not specified the command s response is ok in those cases where it is stated that the user must be logged in the response login please is displayed if the user is not logged in user specifies the user s user name for accounting purposes initiates login and initializes the source print and punch user name accumulators to to complete login this command must be followed by a successful pass command the only other command allowed before the user is logged in is bye the response to a syntactically valid user command is always enter password pass password specifies the user s password to gain access to the user s account completes the login initiated by a previous user command and initializes the source print and punch password accumulators to the response to a successful pass command is user owns remote terminal where is the number of the hasp virtual rje terminal owned by the user the following error replies are possible new users are not being accepted at this time if there is no free hasp terminal to assign to the user there is currently a maximum of or if there are insufficient other resources available to support another user incorrect password if the specified is not that assigned to the previously specified another user is logged in as only one user is allowed logged in with a given at a time acct specifies the ucsb computer center account number to which the user s use of rjs is to be billed and initializes the source print and punch account accumulators to the response to a syntactically correct acct command is ok as previously stated rjs billing is yet to be implemented and therefore the acct command is optional users and writers of user processes are warned however that it will eventually be required and that at that point the pass command will return a reply id of and the acct command will have those replies listed above under pass krilanovich page rfc remote job service at ucsb may bye logs the user out and closes the telnet connections to him regardless of whether there are any file transfers in progress if there are they continue unaltered the response to a bye command is always logout c mpleted transfers if any continue followed by a continuation line of tty is disconnected status lists the user names of those users currently known to rjs the response is either no users are known to rjs or o the following users are known to rjs followed by one or more lines each beginning with a continuation reply id of four blanks giving a remote terminal number the user name of the user who owns that terminal and the name of the site from which he last logged in syntax causes the current command syntax to become local syntax the telnet modes full or half duplex character or line at a time most recently in effect in local syntax again become effective rjs responds with the local syntax prompt character currently number sign the remaining commands require the user to be logged in reinit resets to empty the source print and punch accounting parameter the source print and punch pathname and the login accounting parameter accumulators the response to a reinit command is always ok inuser inid sets the source user name accumulator to user name inpass sets the source password accumulator to inacct sets the source account accumulator to krilanovich page rfc remote job service at ucsb may outuser sets the print and punch user name accumulators to outpass sets the print and punch password accumulators to outacct sets the print and punch account accumulators to inpath d h x o t a n e te ae ne to ascii characters excluding cr and lf codes through excluding and sets the source pathname accumulator to the is the means for specifying a file s source or destination its semantics are as follows specification of indicates that rjs will establish a simplex connection to the stated socket rjs issuing the connect user issuing a listen the data is then transferred over this connection with close signaling end of file if in is defaulted the host containing the telnet user will be assumed specification of indicates that rjs will contact the standard ftp server socket currently socket at the stated host and transfer the data according to the file transfer protocol the referred to here corresponds to the term used in the ftp specification document rfc krilanovich page rfc remote job service at ucsb may the type of carriage control and the data code used are determined by the meaning of this parameter is as follows t ascii code telnet carriage control a ascii code asa carriage control n ascii code no carriage control identical to n for input a for output identical to n for input a for output e identical to ne for input ae for output te ebcdic code telnet carriage control ae ebcdic code asa carriage control ne ebcdic code no carriage control detailed descriptions of the transfer modes may be found below under rjs file transfer outpath out a b h s pathname d stores in the print pathname accumulator if is either a or or in the punch pathname accumulator if is b the meanings of the options for are as follows transmit and discard the file is sent and then deleted h hold only the file is not sent but rather held for user intervention s save the file is sent and then held for user intervention d discard the file is deleted as soon as it is produced input creates a job stores with it the contents of the source print and punch accounting parameter and pathname accumulators and places it in a queue within rjs of jobs owned by the user awaiting source file transfer when it becomes the first or only job in this queue the retrieval of its source file is initiated a job identifier jobid is assigned to the job and displayed to the user the contents of the source and print pathname accumulators must have been set by inpath and outpath commands previous to the input command if successful the message assigned jobid is is krilanovich page rfc remote job service at ucsb may displayed where is that which may used in subsequent rjs commands to identify this particular job if the user is found to own the maximum number of jobs currently an attempt is made to satisfy the request by finding the oldest of the user s jobs that has completed processing if this can be done the old job is deleted and the response to the command is job is being discarded to make room for the new job followed by a continuation line of assigned job id is the following error responses are possible source pathname has not been specified print pathname has not been specified new jobs are not being accepted at this time and user user name already owns the maximum number of jobs change stores as the print pathname of job if is either a or or as the punch pathname if is b if the appropriated file transfer has not yet begun the following error replies are possible job not found o job is already being or has been printed if is a job is already being or has been punched if is b and user does not own job status causes the status of the job known to rjs as to be displayed included in this display are in which stage of rjs processing the job is being read in execution being printed being punched or has completed the pathname information accounting parameters host name socket number attributes disposition and filename for those files source print and punch that have been supplied for the job and if the job has failed at some stage of rjs processing an explanation of the failure the possible responses are job not found and a line with reply code followed by zero or more continuation lines explaining the status of the job cancel causes processing of the job known to rjs as to terminate immediately and all record of it to be deleted if ftp data and or command connections are pending or established they are closed if the job is in execution an os cancel command is issued to terminate execution any output from the job is lost and a subsequent request for status of job will return the diagnostic that the job is not found the successful responses are job deleted krilanovich page rfc remote job service at ucsb may and job will be deleted as soon as possible the possible failure responses are job not found and user does not own job the following standard rjs commands are as yet not implemented and elicit the response command not implemented abort alter back hold op recover restart and skip rjs commands local syntax conventions in addition to those general conventions discussed above the following rules hold for local syntax except in certain circumstances noted below a period may be used for command accept the following control characters have the indicated functions soh control a delete last character del delete last character syn control v delete last word can control x delete entire line eot control d display current word ack control f display entire line display acceptable input forms esc force recognition of current word blank force recognition of current word the telnet control characters you echo and i echo have the desired results you echo also has the effect of changing to character at a time mode if the user is not already in character at a time mode description of rjs commands local syntax the following is a list of those commands supported in local syntax in those cases where no success reply is indicated rjs responds with cr lf followed by the prompt character in those cases where it is stated that the user must be or must not be logged in login please or logged in respectively are displayed if the user is not in the appropriate state when a reference is made to a response listed under a standard syntax command it should be noted that reply id s are not displayed under local syntax fullduplex sets the user to fullduplex and character at a time modes krilanovich page rfc remote job service at ucsb may halfduplex sets the user to halfduplex mode line at a time set s the user to halfduplex line at a time modes the control characters previously described remain effective but rjs will send no output over the telnet connection except when the current command line is empty login specifies the ucsb computer center user name and account to which the user s use of rjs is to be billed logs the user in and sets the source print and punch accounting parameter accumulators to and this command is valid only if the user is not logged in and has the same replies as the standard syntax pass command disconnect closes the telnet connection if the user is logged in he is first logged out the effective action taken in response to an unexpected close on the telnet connection is that of a disconnect the response to a disconnect command is tty is disconnected the remaining commands require the user to be logged in log ut logs the user out and terminates billing of subsequent activity over the telnet connection to the previously effective accounting parameters and performs the effective action of the reinitialize command logout does not close the telnet connection nor does it affect any file transfers in progress for jobs owned by the user reinitialize resets to empty the following accumulators source print and punch accounting parameter source print and punch pathname and login accounting parameter accounting krilanovich page rfc remote job service at ucsb may sets the source print and punch accounting parameters to specification of for any of or indicates use of the contents of the corresponding login accumulator source set the source accounting parameter accumulators to print sets the print accounting parameter accumulators to punch sets the punch accounting parameter accumulators to source sets the source pathname of job to and the source accounting parameters to if specified or otherwise to the contents of the source accounting parameter accumulators if job already exists and its source pathname has not been specified the new pathname is stored if it has been specified it is changed unless source file retrieval has already begun if the job does not already exist a new job is created and the pathname stored restrictions are that if a job with a given has completed processing it must be delete d before that may be used for a new job a user may only alter jobs owned by him and he may not own more than a certain fixed number of jobs currently if the user already owns the maximum number an attempt is made to delete an old job to make room for the new one as described for input under standard syntax the source command has the following possible error responses new jobs are not being accepted at this time user already owns the maximum number of jobs user does not own job job has already completed and job is already being or has been read print sets the print pathname of job to and the print accounting parameters to if specified or otherwise to the contents of the print accounting parameter accumulators the print command either creates a new job or modifies an existing one as explained under source and has the same restrictions and error messages listed for the source command after making the obvious substitution of printed for read the print command is valid only before print file transfer begins krilanovich page rfc remote job service at ucsb may punch sets the punch pathname of job to and the punch accounting parameters to if specified or otherwise to the contents of the punch accounting parameter accumulators the punch command either creates a new job or modifies an existing one like the source and print commands and has the same restrictions and error messages listed for the source command after making the substitution of punched for read the punch command is valid only before punch file transfer begins delete identical in function to the cancel command in standard syntax input places the job identified by in a queue within rjs of jobs owned by the users awaiting source file transfer when it becomes the first or only job in this queue the retrieval of the source file is initiated if the input command is successful the message job accepted for processing is displayed the following error messages are possible job not found user does not own job job has already completed source pathname has not been specified and print pathname has not been specified jobstat identical in function and response to the status command in standard syntax joblist lists the jobid s of those jobs owned by the user a string of any characters including and note that must be cr lf rather than period issues as a hasp operator command over the user s virtual operator s console see appendix a for a description of hasp commands and command responses krilanovich page rfc remote job service at ucsb may rjs file transfer the defined earlier is the means whereby the user specifies the location and attributes of his source print and punch files the means of determining a file s location have been previously discussed this section explains the controls the user has over data attributes the parameter specifies the type of carriage control and the mode of transfer for the case of transfer over a simplex connection this parameter has the following meanings t or te telnet like carriage control the data is a stream of characters with embedded carriage control bytes page eject is signaled by form feed ascii or ebcdic decimal new line by carriage return line feed ascii l lo ebcdic multiple new line double spacing or triple spacing is indicated by multiple occurances of cr lf a or ae asa carriage control the data is a series of fixed length records characters on input on output with the first character of each record an asa carriage control character the possible carriage control characters are as follows no line advance before print overprint one line advance single space two lines advance double space three lines advance triple space and page eject whatever carriage control character appears on input is ignored n or ne no carriage control the data is a series of fixed length records characters on input on output any carriage control generated on output is discarded before transmission when file transfer takes place by means of ftp the interpretation of the parameter is somewhat different in this case the meanings are as follows t or te telnet like carriage control the data has the same format as for the simplex connection and is transferred in stream mode file structure and either ascii a or ebcdic e type a or ae asa carriage control data is transferred in blocked mode record structure and either ascii print p or ebcdic print f type the first character of every record is the asa carriage control character described above krilanovich page rfc remote job service at ucsb may n or ne no carriage control data is transferred in blocked mode record structure and either ascii a or ebcdic e type as for the simplex connection no carriage control information is present in order to effect the ftp file transfer rjs issues the following ftp commands in the given order user if access user name has been specified pass if password specified acct if account specified byte specifying bytesize of allo if outputting file type stru mode sock and appe or retr krilanovich page rfc remote job service at ucsb may appendix a the hasp spooling system hasp is a spooling queuing scheduling system used in conjunction with ibm os to aid in processing of batch jobs the main purpose of hasp is to increase throughput by minimizing i o wait time and providing a priority scheduling scheme whereby shorter jobs are chosen for processing over longer jobs there are several stages of processing or functions within hasp at any instant a given job is either in some stage of processing in which case the job is said to be active or it is waiting to be processed by some function in which case it is said to be queued for that function jobs to be processed by a function are selected from the queue of jobs waiting for that function in order of decreasing priority a job s priority is determined by its estimated cpu tine and volume of output the result is that smaller jobs are selected for processing over larger jobs and therefore spend less time in the system the hasp remote user is provided with a virtual operator s console over this console he may enter hasp operator commands to display information about the system in general and to exercise control over his terminal and his jobs hasp sends messages to his console in response to his commands and to inform him of conditions concerning him as they arise hasp commands have the following general form where a single character verb which identifies the general function to be performed identification of the object to be displayed or acted upon zero or more operands may be present depending on the command and commas are used to separate operands when more than one is used in general alphabetics may be entered in either upper or lower case and for text outside paired apostrophes blanks may be inserted at any point desired apostrophes intended as text characters must appear in duplicate every hasp command ellicts one or more responses the response ok is used in many cases to acknowledge the command and to signify that the requested action has been taken or initiated in the later case an information message will be issued when the request is completed krilanovich page rfc remote job service at ucsb may every hasp console message begins with the text s hh mm ss or s hh mm ss where hh mm ss is the time of day in hours minutes and seconds and in hour clock many commands display job status information as a response the format of this standard response is as follows jobs queued for processing job jjj jobname aw exec class prio prio hold print rem purge punch rem dup purge jobs being processed job jjj jobname executing class prio prio hold on device dev purge is purging where jjj hasp assigned job number jobname os jobname aw awaiting class job s job class prio job s hasp internal priority rem terminal number of remote terminal where job is queued to print or punch dev device name hold signifies job is in hold status or will be at completion of current function purge signifies job will be purged at completion of current function dup signifies job cannot begin execution until another job with same jobname completes the following is a brief description of those hasp operator commands that may be issued by a remote user for a more complete description see nic sda display status information on all active jobs sdf rem display number of jobs queued for special forms sdn queue display status information on all queued jobs sdq display number of queued jobs krilanovich page rfc remote job service at ucsb may scj jjj delete job immediately skj jjj issue os cancel and delete job immediately spj jjj delete job after current function sdj jjj display job status information sd jobname display job status information sb device pages backspace device sc device delete current function on device sf device pages forward space device sdp device display job number of job on device sdi display status and classes of initiators sdline rem display status of remote terminal sdrm rem display status of remote terminal sdu display status of local unit record devices sdm rem message display message to remote console krilanovich page rfc remote job service at ucsb may appendix b rjs reply id s the following is a list of the reply id s of the replies generated by rjs in response to the indicated commands command success reply failure replies user pass acct bye reinit o o o inuser inid inpass inacct outuser outpass outacct inpath outpath out input change status no operand status with operand cancel possible spontaneous reply id s are and this rfc was put into machine readable form for entry into the online rfc archives by mikan mirko krilanovich page 