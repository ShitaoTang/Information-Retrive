 network working group charley kline request for comments johnny wong nic ucla nmc categories c c c c may updates none obsoletes none time out mechanism in the host host protocol on sending a message to a foreign site the following situations can occur destination imp down type message is returned destination imp up but destination imp host interface is down type message is returned destination imp and imp host interface up but imp host inter face is not taking messages type message is returned after imp time out ask bbn for time destination imp and imp host interface up and imp host inter face is taking messages type rfnm message is returned a suggestion for handling type and type messages has been made in nwg rfc in this document we would like to discuss in detail the problem what should happen to the host host protocol on receiving a rfnm when a ncp sends out a str or rts control command on a pair of sockets and gets a rfnm back this pair of sockets will be in a wait match state everything is fine if a matching rts or str or cls is returned after a reasonable amount of delay trouble will arise when nothing is returned after a long time this can happen if the ncp is not running at all but its host is taking in messages e g ucla s host will receive messages even if the ncp is not running or if the ncp is running very slowly the same problem exists on sending out a cls control command and a matching cls is never returned the trouble is that resources are tied up e g sockets links and table space in the ncp and one would like to release these resources in our implementation when a user does a close we can t release the sockets until the matching cls is returned this protects us from getting confused if a seconds request is made for the same pair of sockets this problem can be solved by including a time out mechanism in the host host protocol this operates as follows page ne a on sending out a str or rts and if you do not get back a match ing rts or str or a cls in t time units a cls will be sent after sending the time out cls race condition can be avoided by ignoring the matching rts or str that arrives before the matching cls b on sending out a cls any kind including the time out cls and if you do not get back a matching cls in t time units the matching cls is assumed to have returned however if a rts or str is sent on the same pair of sockets anytime after the time out and before a cls is returned and then we receive the cls there is no way to determine whether this returning cls is for matching the previous cls or for refusing the rts or str see the figure for detail so far we could not solve this race condition except by assigning sequence number to connection throughout the network which we don t think is a good solution at all hence we would like to bring the attention of the host host protocol glitch cleaning committe to this problem the time limit t should be a network standard and its value should be decided also reason our ncp user requests connection rts user gets tired requests cls or ncp timeout cls no matching cls returned in t time units cls assumed returned free socket and other resources user requests another connection over same socket pair rts cls received does it belong to or figure this rfc was put into machine readable form for entry into the online rfc archives by gert doering page 